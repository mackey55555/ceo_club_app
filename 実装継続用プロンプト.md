# CEO倶楽部 イベント管理アプリ - 実装継続用プロンプト

## プロジェクト概要

CEO倶楽部のイベント管理アプリケーション。モバイルアプリ（React Native/Expo）、管理画面（Next.js）、Webページ（Next.js）で構成されています。

- **メインカラー**: `#243266`
- **サブカラー**: `#a8895b`
- **バックエンド**: Supabase (PostgreSQL)
- **ORM**: Prisma
- **リポジトリ**: `git@github.com:auris-inc/ceo_club_app.git`

## 技術スタック

### モバイルアプリ (`mobile-app/`)
- React Native (Expo)
- Expo Router
- Zustand (状態管理)
- NativeWind (Tailwind CSS)
- Supabase Client

### 管理画面 (`admin/`)
- Next.js 16.1.1
- React 19.2.3
- TypeScript
- Tailwind CSS
- Supabase Client
- bcryptjs (パスワード検証)

### データベース
- Supabase PostgreSQL
- Prisma ORM
- マイグレーション: `supabase/migrations/`
- シーダー: `prisma/seed.sql`, `prisma/seed.ts`

## 実装済み機能

### モバイルアプリ
✅ 認証機能（ログイン、登録）
✅ お知らせ一覧・詳細画面
✅ イベント一覧・詳細画面（リスト/カレンダー/場所ビュー、フィルター機能）
✅ 参加履歴画面（フィルター機能）
✅ イベント報告記画面（WebView）
✅ 会員証画面・プロフィール編集
✅ カスタムヘッダー・タブバー
✅ スプラッシュスクリーン（ロゴ設定済み）

### 管理画面
✅ ログイン機能（パスワード検証: bcrypt）
✅ ダッシュボード
✅ 会員管理機能
  - 会員一覧（検索、フィルター）
  - 承認待ち一覧
  - 会員詳細・編集
  - 会員作成
  - 承認/却下機能
✅ お知らせ管理機能
  - お知らせ一覧（検索、フィルター、削除）
  - お知らせ作成
  - お知らせ編集
✅ イベント管理機能
  - イベント一覧（検索、フィルター、削除）

## 残りの実装タスク

### 管理画面 - イベント管理機能
1. **イベント作成/編集画面** (`/admin/events/[id]`)
   - パス: `admin/app/admin/events/[id]/page.tsx`
   - 必要なフィールド:
     - タイトル（必須）
     - 本文（必須、リッチエディタ推奨）
     - サムネイルURL
     - 開催日（必須）
     - 開始時刻
     - 終了時刻
     - 開催場所
     - 定員
     - キャンセル期限
     - ステータス（draft/published/closed/cancelled）
     - 公開日時
     - 非会員申込み許可（boolean）
   - 参考: `admin/app/admin/news/[id]/page.tsx` の実装パターン
   - データベーステーブル: `events`

2. **イベント作成画面** (`/admin/events/new`)
   - パス: `admin/app/admin/events/new/page.tsx`
   - 上記と同じフィールド
   - 参考: `admin/app/admin/news/new/page.tsx` の実装パターン

3. **申込み一覧画面** (`/admin/events/[id]/applications`)
   - パス: `admin/app/admin/events/[id]/applications/page.tsx`
   - イベント参加者の一覧表示
   - 会員申込み（`event_applications`テーブル）
   - 非会員申込み（`guest_applications`テーブル）
   - CSVエクスポート機能（オプション）
   - 参考: `admin/app/admin/members/page.tsx` のテーブル実装パターン

## データベース構造（関連テーブル）

### events テーブル
```sql
- id (UUID, PK)
- title (VARCHAR(200), NOT NULL)
- body (TEXT, NOT NULL)
- thumbnail_url (VARCHAR(500))
- event_date (DATE, NOT NULL)
- start_time (TEXT)
- end_time (TEXT)
- venue (VARCHAR(200))
- capacity (INTEGER)
- cancel_deadline (TIMESTAMPTZ)
- status_id (UUID, FK -> event_statuses)
- publish_at (TIMESTAMPTZ)
- allow_guest (BOOLEAN, DEFAULT false)
- created_by (UUID, FK -> users)
- created_at (TIMESTAMPTZ)
- updated_at (TIMESTAMPTZ)
```

### event_statuses テーブル
- `00000000-0000-0000-0000-000000000201`: draft
- `00000000-0000-0000-0000-000000000202`: published
- `00000000-0000-0000-0000-000000000203`: closed
- `00000000-0000-0000-0000-000000000204`: cancelled

### event_applications テーブル（会員申込み）
```sql
- id (UUID, PK)
- event_id (UUID, FK -> events)
- user_id (UUID, FK -> users)
- status (VARCHAR(20), DEFAULT 'applied')
- applied_at (TIMESTAMPTZ)
- cancelled_at (TIMESTAMPTZ)
```

### guest_applications テーブル（非会員申込み）
```sql
- id (UUID, PK)
- event_id (UUID, FK -> events)
- email (VARCHAR(255))
- full_name (VARCHAR(100))
- company_name (VARCHAR(200))
- job_title (VARCHAR(100))
- status (VARCHAR(20), DEFAULT 'applied')
- applied_at (TIMESTAMPTZ)
- cancelled_at (TIMESTAMPTZ)
```

## 実装時の注意点

### 1. セッション管理
- すべての管理画面ページでセッション確認が必要
- `localStorage.getItem('admin_session')` で確認
- セッションがない場合は `/admin/login` にリダイレクト

### 2. UI/UX統一
- 入力フィールド: `text-gray-900 bg-white placeholder:text-gray-500`
- プルダウン: `text-gray-900 bg-white`
- ボタン: メインカラー `#243266` を使用
- 赤色は使用しない（停止中はオレンジ、却下ボタンはグレー）

### 3. エラーハンドリング
- try-catch でエラーをキャッチ
- ユーザーに分かりやすいエラーメッセージを表示
- console.error でログ出力

### 4. 日時フォーマット
- 表示: `YYYY年MM月DD日` または `YYYY年MM月DD日 HH:MM`
- 入力: `datetime-local` または `date` タイプを使用
- データベース保存時は ISO 形式に変換

### 5. リッチエディタ
- 現在は `textarea` で実装
- 将来的にリッチエディタ（react-quill等）を追加する可能性あり
- 本文は `TEXT` 型で保存

### 6. 管理者IDの取得
```typescript
const session = localStorage.getItem('admin_session');
const admin = JSON.parse(session);
const adminId = admin.id; // created_by に使用
```

## 参考実装ファイル

### 会員管理（参考）
- 一覧: `admin/app/admin/members/page.tsx`
- 詳細/編集: `admin/app/admin/members/[id]/page.tsx`
- 作成: `admin/app/admin/members/new/page.tsx`

### お知らせ管理（参考）
- 一覧: `admin/app/admin/news/page.tsx`
- 詳細/編集: `admin/app/admin/news/[id]/page.tsx`
- 作成: `admin/app/admin/news/new/page.tsx`

### イベント管理（参考）
- 一覧: `admin/app/admin/events/page.tsx` ✅ 実装済み

## Supabase接続情報

- URL: `https://zoacscfmsuezjgldkjze.supabase.co`
- Anon Key: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpvYWNzY2Ztc3VlempnbGRranplIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYzODk2MTMsImV4cCI6MjA1MTk2NTYxM30.yHLvcI1-vc1y9bMNkVJ0IQ_STFPJRZ-`
- データベースパスワード: `ceo-club-app`

## 管理者ログイン情報（テスト用）

- メールアドレス: `admin@example.com`
- パスワード: `admin123`

## 次のステップ

1. イベント作成/編集画面の実装
   - `admin/app/admin/events/[id]/page.tsx` を作成
   - すべてのフィールドを含むフォームを実装
   - 作成・更新・削除機能を実装

2. イベント作成画面の実装
   - `admin/app/admin/events/new/page.tsx` を作成
   - または `[id]` で `new` を判定して同じコンポーネントを使用

3. 申込み一覧画面の実装
   - `admin/app/admin/events/[id]/applications/page.tsx` を作成
   - 会員申込みと非会員申込みを表示
   - テーブル形式で一覧表示

## 実装コマンド

```bash
# 開発サーバー起動（管理画面）
cd admin && npm run dev

# データベースシーダー実行
npm run db:seed

# Prisma Studio起動
npm run db:studio
```

## その他の注意事項

- 日本語で実装（ラベル、メッセージ等）
- レスポンシブデザインを考慮
- アクセシビリティに配慮（適切なlabel、aria属性等）
- コードは既存のパターンに従う

